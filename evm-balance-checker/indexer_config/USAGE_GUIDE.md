# DeFi Indexer - Quick Start Guide

## ğŸš€ What This Does

This indexer tracks **real-time DeFi positions** across 6 EVM chains:
- Ethereum, Arbitrum, Polygon, Optimism, Avalanche, Base

## ğŸ“Š Protocols Tracked

### Lending (2 protocols)
- **Aave V3** - Supply, Withdraw, Borrow, Repay, Liquidations
- **Compound V3** - Supply, Withdraw, Collateral management

### DEX (4 protocols)
- **Uniswap V3** - LP positions, liquidity changes
- **Curve** - Pool liquidity
- **Balancer V2** - Pool balances, swaps

### Staking (2 protocols)
- **Lido** - stETH staking
- **Rocket Pool** - rETH staking

### Perpetuals (1 protocol)
- **GMX** - GLP liquidity

## ğŸ› ï¸ Setup

### 1. Install rindexer

```bash
cargo install rindexer
```

### 2. Set RPC URLs (optional)

By default, public RPCs are used. For better performance:

```bash
export ETHEREUM_RPC_URL="https://your-ethereum-rpc"
export ARBITRUM_RPC_URL="https://your-arbitrum-rpc"
export POLYGON_RPC_URL="https://your-polygon-rpc"
export OPTIMISM_RPC_URL="https://your-optimism-rpc"
export AVALANCHE_RPC_URL="https://your-avalanche-rpc"
export BASE_RPC_URL="https://your-base-rpc"
```

### 3. Run the indexer

```bash
cd indexer_config
rindexer start all
```

## ğŸ“ˆ What Gets Indexed

Every DeFi event is captured with:
- **User address** - Who performed the action
- **Token/Asset** - Which token was involved
- **Amount** - How much
- **Timestamp** - When it happened
- **Block number** - Exact block
- **Transaction hash** - Full traceability

## ğŸ” Example Queries

After indexing, query the database:

```sql
-- Get all Aave supplies by a user
SELECT * FROM aave_v3_pool_supply 
WHERE user = '0x...' 
ORDER BY block_number DESC;

-- Get total supplied across all protocols
SELECT SUM(amount) as total_supplied
FROM aave_v3_pool_supply
WHERE user = '0x...';

-- Get Uniswap V3 LP positions
SELECT * FROM uniswap_v3_nft_manager_increase_liquidity
WHERE token_id IN (
  SELECT token_id FROM uniswap_v3_nft_manager_transfer
  WHERE to = '0x...'
);
```

## ğŸ“ Generated Files

```
indexer_config/
â”œâ”€â”€ rindexer.yaml          # Main configuration
â”œâ”€â”€ abis/                  # Contract ABIs
â”‚   â”œâ”€â”€ aave_v3_pool_ethereum.json
â”‚   â”œâ”€â”€ compound_v3_usdc_ethereum.json
â”‚   â””â”€â”€ ... (40+ ABI files)
â””â”€â”€ USAGE_GUIDE.md         # This file
```

## ğŸ”„ Regenerating Config

To update the configuration:

```bash
python generate_indexer.py
```

## âš™ï¸ Advanced Options

### Index specific chains only

Edit `rindexer.yaml` and remove unwanted networks.

### Change start blocks

Update `start_block` values in the YAML to index from earlier blocks.

### Add custom protocols

Edit `generate_indexer.py` and add to the `PROTOCOLS` dictionary.

## ğŸ“Š Performance Tips

1. **Use archive nodes** for historical data
2. **Start from recent blocks** (`latest`) for faster sync
3. **Use dedicated RPC endpoints** for better rate limits
4. **Run in Docker** for production deployments

## ğŸ³ Docker Deployment (Optional)

```dockerfile
FROM rust:latest
RUN cargo install rindexer
COPY indexer_config /app
WORKDIR /app
CMD ["rindexer", "start", "all"]
```

## ğŸ“ Notes

- All contract addresses are **production-verified**
- Start blocks are set to contract deployment blocks
- ABIs include only the events needed for position tracking
- Public RPCs are used by default (can be slow)

## ğŸ†˜ Troubleshooting

**Slow syncing?**
- Use a paid RPC provider (Alchemy, Infura, QuickNode)
- Start from `latest` block instead of historical

**Missing events?**
- Check if the protocol is active on that chain
- Verify the contract address is correct

**Database errors?**
- Ensure PostgreSQL is running
- Check rindexer logs for details

## ğŸ“š Resources

- [rindexer Documentation](https://github.com/joshstevens19/rindexer)
- [Aave V3 Docs](https://docs.aave.com/developers/)
- [Uniswap V3 Docs](https://docs.uniswap.org/contracts/v3/overview)

---

**Generated by**: DeFi Indexer Generator
**Date**: Auto-generated
**License**: MIT
